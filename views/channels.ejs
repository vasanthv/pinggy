<!doctype html>
<html lang="en">
<%- include('partials/html-head'); -%>
<body onload="App.getChannels()">
<div id="app" class="wrap">
  <%- include('partials/header'); -%>
  <div id="titleBar" class="flex space-between">
    <h1 class="page-title flex-1">channels</h1>

    <button class="link icon" v-on:click="showAdd = !showAdd">
      <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
        <path
                d="M5 13h6v6c0 0.552 0.448 1 1 1s1-0.448 1-1v-6h6c0.552 0 1-0.448 1-1s-0.448-1-1-1h-6v-6c0-0.552-0.448-1-1-1s-1 0.448-1 1v6h-6c-0.552 0-1 0.448-1 1s0.448 1 1 1z"
        ></path>
      </svg>
    </button>
  </div>

  <section id="addURL" v-if="showAdd">
    <div class="flex">
      <input
              type="url"
              class="flex-1"
              v-model="addURL"
              placeholder="Enter feed URL"
              v-on:keyup.enter="subscribeChannel"
      />
      <button v-on:click="subscribeChannel" v-bind:disabled="isSaving">+ Add</button>
    </div>
  </section>
  <section>
    <div v-for="(channel, i) in channels" v-bind:key="channel._id" class="item">
      <div class="row">
        <div class="link">
          <a v-bind:href="'/channel/'+channel._id" class="title" rel="noopener noreferrer">{{channel.title}}</a>
          <div class="meta light">
            <img v-if="channel.imageURL" v-bind:src="channel.imageURL" v-bind:alt="channel.title" />
            <span>Fetched {{displayDate(channel.lastFetchedOn)}}</span>
            <span> &middot; </span>
            <a href="javascript:void(0)" v-on:click="unsubscribeChannel(channel._id)">Remove</a>
          </div>
        </div>
      </div>
    </div>
    <p v-if="channels.length === 0 && !isLoading" class="empty">You are not subscribed to any channels</p>
    <div v-if="isLoading" class="loader"></div>
  </section>
  <%- include('partials/footer'); -%>
</div>
</body>
</html>
